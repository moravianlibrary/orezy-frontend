@let mode = imagesService.mode();
@let isSingle = mode === 'single';

<!-- CUSTOM CROPPED IMAGES -->
@let customCropped = imagesService.customCroppedImages();
@if (isSingle && customCropped.length) {
  <div class="thumbnails-customCropped-wrapper">
    <p>Vlastn√≠ p≈ôidan√© o≈ôezy - obd√©ln√≠ky ({{ customCropped.length }}):</p>
    @for (image of customCropped; track $index) {
      <div class="thumbnail-wrapper">
        <img
          [src]="image.url"
          [class.selected]="
            imagesService.mainImageItem().name === image.name &&
            imagesService.mainImageItem().crop_part === image.crop_part
          "
          (click)="imagesService.setMainImage(image)"
        />
      </div>
    }
  </div>
 }

<!-- FLAGGED IMAGES -->
<div class="thumbnails-flagged-wrapper">
  @let flaggedImages = isSingle
    ? imagesService.flaggedCroppedImages()
    : imagesService.flaggedImages();
  @let notFlaggedImages = isSingle
    ? imagesService.notFlaggedCroppedImages()
    : imagesService.notFlaggedImages();

  @if (flaggedImages.length) {
    <p>Skeny v nepo≈ô√°dku ({{ flaggedImages.length }}):</p>

    @for (image of flaggedImages; track $index) {
      <div class="thumbnail-wrapper">
        <img
          [src]="image.url"
          [class.selected]="
            imagesService.mainImageItem().name === image.name &&
            imagesService.mainImageItem().crop_part === image.crop_part
          "
          (click)="imagesService.setMainImage(image)"
        />
        <div class="thumbnail-icons">
          @if (image.low_confidence) { ü´• }
          @if (image.bad_sides_ratio) { üìê }
        </div>
      </div>
    }
  } @else {
    <p>
      {{
        imagesService.loading
          ? 'Skeny se naƒç√≠taj√≠...'
          : 'V≈°echny skeny jsou v po≈ô√°dku.'
      }}
    </p>
  }
</div>


<!-- TOGGLE MORE -->
@if (notFlaggedImages.length) {
  <button (click)="toggleMorePreview()">
    {{ imagesService.toggledMore ? 'Skr√Ωt' : 'Zobrazit' }}
    zbytek, co je cajko≈° ({{ notFlaggedImages.length }})
  </button>
}


<!-- NOTFLAGGED IMAGES -->
<div class="thumbnails-notflagged-wrapper">
  @if (imagesService.toggledMore) {
    @if (notFlaggedImages.length) {
      @for (image of notFlaggedImages; track $index) {
        <div class="thumbnail-wrapper">
          <img
            [src]="image.url"
            [class.selected]="
              imagesService.mainImageItem().name === image.name &&
              imagesService.mainImageItem().crop_part === image.crop_part
            "
            (click)="imagesService.setMainImage(image)"
          />
        </div>
      }
    } @else {
      <p>≈Ω√°dn√© skeny nejsou v po≈ô√°dku.</p>
    }
  }
</div>
